<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">

    <!-- This Handlebars template wraps compiled markdown documents
         into complete HTML pages that look kind of like pages from
         a GitHub Wiki.

         Used in compileMarkdown.js
         
         Created by Curran Kelleher March 2015 -->
  
    <!-- Use Github-like style, from https://github.com/sindresorhus/github-markdown-css -->
    <link rel="stylesheet" type="text/css" href="github-markdown.css">

    <!-- CSS that makes the page look more like the GitHub Wiki. -->
    <link rel="stylesheet" type="text/css" href="github-wiki.css">
  
    <title>Transitions</title>
  </head>
  <body>
    <div class="markdown-body">
      <h1>Transitions</h1>
      <blockquote>
<p><a href="Home">Wiki</a> ▸ [[API Reference]] ▸ [[Core]] ▸ <strong>Transitions</strong></p>
</blockquote>
<p>A transition is a special type of [[selection|Selections]] where the operators apply smoothly over time rather than instantaneously. You derive a transition from a selection using the [[transition|Selections#transition]] operator. While transitions generally support the same operators as selections (such as <a href="Transitions#attr">attr</a> and <a href="Transitions#style">style</a>), not all operators are supported; for example, you must append elements before a transition starts. A <a href="Transitions#remove">remove</a> operator is provided for convenient removal of elements when the transition ends.</p>
<p>Transitions may have per-element delays and durations, computed using functions of data similar to other operators. This makes it easy to stagger a transition for different elements, either based on data or index. For example, you can sort elements and then stagger the transition for better perception of element reordering during the transition. For more details on these techniques, see [[&quot;Animated Transitions in Statistical Data Graphics&quot;|<a href="http://vis.berkeley.edu/papers/animated_transitions/">http://vis.berkeley.edu/papers/animated_transitions/</a>]] by Heer &amp; Robertson.</p>
<p>D3 has many built-in interpolators to simplify the transitioning of arbitrary values. For instance, you can transition from the font string &quot;500 12px sans-serif&quot; to &quot;300 42px sans-serif&quot;, and D3 will find the numbers embedded within the string, interpolating both font size and weight automatically. You can even interpolate arbitrary nested objects and arrays or SVG path data. D3 allows custom interpolators should you find the built-in ones insufficient, using the <a href="Transitions#attrTween">attrTween</a> and <a href="Transitions#styleTween">styleTween</a> operators. D3&#39;s interpolators provide the basis for [[scales|Scales]] and can be used outside of transitions; an interpolator is a function that maps a parametric value <em>t</em> in the domain [0,1] to a color, number or arbitrary value.</p>
<p>Only one transition may be <em>active</em> on a given element at a given time. However, multiple transitions may be <em>scheduled</em> on the same element; provided they are staggered in time, each transition will run in sequence. If a newer transition runs on a given element, it implicitly cancels any older transitions, including any that were scheduled but not yet run. This allows new transitions, such as those in response to a new user event, to supersede older transitions even if those older transitions are staged or have staggered delays. Multi-stage transitions (transitions that are created during the &quot;end&quot; event of an earlier transition) are considered the same &quot;age&quot; as the original transition; internally this is tracked by monotonically-increasing unique IDs which are inherited when multi-stage transitions are created. To interrupt an in-progress transition, use <a href="Selections#interrupt">selection.interrupt</a>.</p>
<p>For more on transitions, read the <a href="http://bost.ocks.org/mike/transition/">Working with Transitions</a> tutorial.</p>
<h2 id="starting-transitions">Starting Transitions</h2>
<p>Transitions are created using the [[transition|Selections#transition]] operator on a selection. Transitions start automatically upon creation after a delay which defaults to zero; however, note that a zero-delay transition actually starts after a minimal (~17ms) delay, pending the first timer callback. Transitions have a default duration of 250ms.</p>
<p><a name="d3_transition" href="#d3_transition">#</a> d3.<b>transition</b>([<i>selection</i>], [<i>name</i>])</p>
<p>Create an animated transition. This is equivalent to <code>d3.select(document).transition()</code>. This method is used rarely, as it is typically easier to derive a transition from an existing selection, rather than deriving a selection from an existing transition. If <em>name</em> is specified, create a transition with the specified name; otherwise, use the empty name (“”).</p>
<p>When called with an optional <em>selection</em>, this method typically returns the specified selection; i.e., it is a no-op. However, within the context of <a href="#each">transition.each</a>, this method will create a new transition for the specified selection that inherits the delay, duration and other properties of the parent transition. This is useful for implementing <a href="http://bost.ocks.org/mike/chart/">reusable components</a> that can be called either on selections or on transitions, in the latter case supporting deriving concurrent transitions. An example of this is D3’s <a href="SVG-Axes">axis component</a>.</p>
<p><a name="delay" href="Transitions#delay">#</a> transition.<b>delay</b>([<i>delay</i>])</p>
<p>Specifies the transition <em>delay</em> in milliseconds. If <em>delay</em> is a constant, then all elements are given the same delay; otherwise, if <em>delay</em> is a function, then the function is evaluated for each selected element (in order), being passed the current datum <code>d</code> and the current index <code>i</code>, with the <code>this</code> context as the current DOM element. The function&#39;s return value is then used to set each element&#39;s delay. The default delay is 0. If <em>delay</em> is not specified, returns the delay bound to the first non-null element in the transition.</p>
<p>Setting the delay to be a multiple of the index <code>i</code> is a convenient way to stagger transitions for elements. For example, if you used a fixed duration of <em>duration</em>, and have <em>n</em> elements in the current selection, you can stagger the transition over 2 * <em>duration</em> by saying:</p>
<pre><code class="lang-javascript">.delay(function(d, i) { return i / n * duration; })
</code></pre>
<p>You may also compute the delay as a function of the data, thereby creating a data-driven animation.</p>
<p><a name="duration" href="Transitions#duration">#</a> transition.<b>duration</b>([<i>duration</i>])</p>
<p>Specifies per-element <em>duration</em> in milliseconds. If <em>duration</em> is a constant, then all elements are given the same duration; otherwise, if <em>duration</em> is a function, then the function is evaluated for each selected element (in order), being passed the current datum <code>d</code> and the current index <code>i</code>, with the <code>this</code> context as the current DOM element. The function&#39;s return value is then used to set each element&#39;s duration. The default duration is 250ms. If <em>duration</em> is not specified, returns the duration bound to the first non-null element in the transition.</p>
<p><a name="ease" href="Transitions#ease">#</a> transition.<b>ease</b>([<i>value</i>[, <i>arguments</i>]])</p>
<p>Specifies the transition [[easing function|<a href="http://www.robertpenner.com/easing/">http://www.robertpenner.com/easing/</a>]]. If <em>value</em> is a function, it is used to ease the current parametric timing value <em>t</em>, which is typically in the range [0,1]. (At the end of a transition, <em>t</em> may be slightly greater than 1.) Otherwise, <em>value</em> is assumed to be a string and the arguments are passed to the <a href="Transitions#d3_ease">d3.ease</a> method to generate an easing function. The default easing function is &quot;cubic-in-out&quot;. Note that it is not possible to customize the easing function per-element or per-attribute; however, if you use the &quot;linear&quot; easing function, you can apply custom easing inside your interpolator using <a href="Transitions#attrTween">attrTween</a> or <a href="Transitions#styleTween">styleTween</a>. If <em>ease</em> is not specified, returns the easing function bound to the first non-null element in the transition.</p>
<h2 id="operating-on-transitions">Operating on Transitions</h2>
<h3 id="content">Content</h3>
<p><a name="attr" href="Transitions#attr">#</a> transition.<b>attr</b>(<i>name</i>, <i>value</i>)</p>
<p>Transitions the value of the attribute with the specified <em>name</em> to the specified <em>value</em>. The starting value of the transition is the current attribute value(be sure to set an initial value beforehand if you don&#39;t want bad surprises), and the ending value is the specified <em>value</em>.  If <em>value</em> is a constant, then all elements are transitioned to the same attribute value; otherwise, if <em>value</em> is a function, then the function is evaluated for each selected element (in order), being passed the current datum <code>d</code> and the current index <code>i</code>, with the <code>this</code> context as the current DOM element. The function&#39;s return value is then used to transition each element&#39;s attribute. Null values are not supported because the interpolator would be undefined; if you want to remove the attribute after the transition finishes, use <a href="Transitions#remove">remove</a>.</p>
<p>An interpolator is selected automatically based on the ending value. If the ending value is a number, the starting value is coerced to a number and <a href="Transitions#d3_interpolateNumber">interpolateNumber</a> is used. If the ending value is a string, a check is performed to see if the string represents a color of the form <code>/^(#|rgb\(|hsl\()/</code>, or one of the [[CSS named colors|<a href="http://www.w3.org/TR/SVG/types.html#ColorKeywords">http://www.w3.org/TR/SVG/types.html#ColorKeywords</a>]]; if so, the starting value is coerced to an RGB color and <a href="Transitions#d3_interpolateRgb">interpolateRgb</a> is used. Otherwise, <a href="Transitions#d3_interpolateString">interpolateString</a> is used, which interpolates numbers embedded within strings.</p>
<p><a name="attrTween" href="Transitions#attrTween">#</a> transition.<b>attrTween</b>(<i>name</i>, <i>tween</i>)</p>
<p>Transitions the value of the attribute with the specified <em>name</em> according to the specified <em>tween</em> function. The starting and ending value of the transition are determined by <em>tween</em>; the <em>tween</em> function is invoked when the transition starts on each element, being passed the current datum <code>d</code>, the current index <code>i</code> and the current attribute value <code>a</code>, with the <code>this</code> context as the current DOM element. The return value of <em>tween</em> must be an interpolator: a function that maps a parametric value <em>t</em> in the domain [0,1] to a color, number or arbitrary value.</p>
<p>For example, the attr operator is built on top of the attrTween operator. The tween function used by the attr operator depends on whether the end value is a function or a constant. If the end value is a function:</p>
<pre><code class="lang-javascript">function tween(d, i, a) {
  return d3.interpolate(a, String(value.call(this, d, i)));
}
</code></pre>
<p>Otherwise, if the end value is a constant:</p>
<pre><code class="lang-javascript">function tween(d, i, a) {
  return d3.interpolate(a, String(value));
}
</code></pre>
<p>The attrTween operator is used when you need a custom interpolator, such as one that understands the semantics of SVG path data. One common technique is <em>dataspace interpolation</em>, where <a href="Transitions#d3_interpolateObject">interpolateObject</a> is used to interpolate two data values, and the result of this interpolation is then used (say, with a [[shape|SVG-Shapes]]) to compute the new attribute value. Use the attr operator for the simpler common case where an interpolator can be automatically derived from the current attribute value to the desired end value.</p>
<p><a name="style" href="Transitions#style">#</a> transition.<b>style</b>(<i>name</i>, <i>value</i>[, <i>priority</i>])</p>
<p>Transitions the value of the CSS style property with the specified <em>name</em> to the specified <em>value</em>. An optional <em>priority</em> may also be specified, either as null or the string &quot;important&quot; (without the exclamation point). The starting value of the transition is the current computed style property value, and the ending value is the specified <em>value</em>.  If <em>value</em> is a constant, then all elements are transitioned to the same style property value; otherwise, if <em>value</em> is a function, then the function is evaluated for each selected element (in order), being passed the current datum <code>d</code> and the current index <code>i</code>, with the <code>this</code> context as the current DOM element. The function&#39;s return value is then used to transition each element&#39;s style property. Null values are not supported because the interpolator would be undefined; if you want to remove the style property after the transition finishes, listen to the <a href="Transitions#each">end</a> event.</p>
<p>An interpolator is selected automatically based on the ending value. If the ending value is a number, the starting value is coerced to a number and <a href="Transitions#d3_interpolateNumber">interpolateNumber</a> is used. If the ending value is a string, a check is performed to see if the string represents a color of the form <code>/^(#|rgb\(|hsl\()/</code>, or one of the [[CSS named colors|<a href="http://www.w3.org/TR/SVG/types.html#ColorKeywords">http://www.w3.org/TR/SVG/types.html#ColorKeywords</a>]]; if so, the starting value is coerced to an RGB color and <a href="Transitions#d3_interpolateRgb">interpolateRgb</a> is used. Otherwise, <a href="Transitions#d3_interpolateString">interpolateString</a> is used, which interpolates numbers embedded within strings.</p>
<p>Note that the computed starting value may be different than the value that was previously set, particularly if the style property was set using a shorthand property (such as the &quot;font&quot; style, which is shorthand for &quot;font-size&quot;, &quot;font-face&quot;, etc.).  Moreover, computed dimensions such as &quot;font-size&quot; and &quot;line-height&quot; are always in pixels, so you should specify the ending value in pixels too if appropriate.</p>
<p><a name="styleTween" href="Transitions#styleTween">#</a> transition.<b>styleTween</b>(<i>name</i>, <i>tween</i>[, <i>priority</i>])</p>
<p>Transitions the value of the CSS style property with the specified <em>name</em> according to the specified <em>tween</em> function. An optional <em>priority</em> may also be specified, either as null or the string &quot;important&quot; (without the exclamation point). The starting and ending value of the transition are determined by <em>tween</em>; the <em>tween</em> function is invoked when the transition starts on each element, being passed the current datum <code>d</code>, the current index <code>i</code> and the current attribute value <code>a</code>, with the <code>this</code> context as the current DOM element. The return value of <em>tween</em> must be an interpolator: a function that maps a parametric value <em>t</em> in the domain [0,1] to a color, number or arbitrary value.</p>
<p>For example, the style operator is built on top of the styleTween operator. The tween function used by the style operator depends on whether the end value is a function or a constant. If the end value is a function:</p>
<pre><code class="lang-javascript">function tween(d, i, a) {
  return d3.interpolate(a, String(value.call(this, d, i)));
}
</code></pre>
<p>Otherwise, if the end value is a constant:</p>
<pre><code class="lang-javascript">function tween(d, i, a) {
  return d3.interpolate(a, String(value));
}
</code></pre>
<p>The styleTween operator is used when you need a custom interpolator, such as one that understands the semantics of CSS3 transforms. Use the style operator for the simpler common case where an interpolator can be automatically derived from the current computed style property value to the desired end value.</p>
<p><a name="text" href="Transitions#text">#</a> transition.<b>text</b>(<i>value</i>)</p>
<p>The <code>text</code> operator is based on the [[textContent|<a href="http://www.w3.org/TR/DOM-Level-3-Core/core.html#Node3-textContent">http://www.w3.org/TR/DOM-Level-3-Core/core.html#Node3-textContent</a>]] property; setting the text content will replace any existing child elements.</p>
<p>Set the text content to the specified value on all selected elements when the transition starts. If <em>value</em> is a constant, then all elements are given the same text content; otherwise, if <em>value</em> is a function, then the function is evaluated for each selected element (in order), being passed the current datum <code>d</code> and the current index <code>i</code>, with the <code>this</code> context as the current DOM element. The function&#39;s return value is then used to set each element&#39;s text content. A null value will clear the content.</p>
<p><a name="tween" href="Transitions#tween">#</a> transition.<b>tween</b>(<i>name</i>, <i>factory</i>)</p>
<p>Registers a custom tween for the specified <em>name</em>. When the transition starts, the specified <em>factory</em> function will be invoked for each selected element in the transition, being passed that element&#39;s data (<em>d</em>) and index (<em>i</em>) as arguments, with the element as the context (<code>this</code>). The factory should return the tween function to be called over the course of the transition. The tween function is then called repeatedly, being passed the current normalized time <em>t</em> in [0, 1]. If the factory returns null, then the tween is not run on the selected element.</p>
<p>The tween method is used internally to implement <a href="#attr">attr</a> and <a href="#style">style</a> tweens, and can be used to interpolate other document content. For example, to interpolate text content from 0 to 100:</p>
<pre><code class="lang-javascript">selection.transition().tween(&quot;text&quot;, function() {
  var i = d3.interpolateRound(0, 100);
  return function(t) {
    this.textContent = i(t);
  };
});
</code></pre>
<p>Tweens are often written using closures to capture state created when the transition starts. In the example above, the interpolator <code>i</code> is initialized when the transition starts, and then used subsequently over the course of the transition. (Though note that in the above example, the starting value of the transition is hard-coded to zero, whereas more commonly the starting value of the transition is based on the current state in the DOM.)</p>
<p><a name="remove" href="Transitions#remove">#</a> transition.<b>remove</b>()</p>
<p>Remove the selected elements at the end of a transition. If a newer transition is scheduled on any of the selected elements, these elements will not be removed; however, the &quot;end&quot; event will still be dispatched.</p>
<h3 id="subtransitions">Subtransitions</h3>
<p>Transitions may be derived from existing transitions, in a similar manner to subselections. Subtransitions inherit easing, duration and delay from the parent transition.</p>
<p><a name="select" href="Transitions#select">#</a> transition.<b>select</b>(<i>selector</i>)</p>
<p>For each element in the current transition, selects the first descendant element that matches the specified <em>selector</em> string. If no element matches the specified selector for the current element, the element at the current index will be null in the returned selection; operators (with the exception of <a href="Transitions#data">data</a>) automatically skip null elements, thereby preserving the index of the existing selection. If the current element has associated data, this data is inherited by the returned subselection, and automatically bound to the newly selected elements. If multiple elements match the selector, only the first matching element in document traversal order will be selected.</p>
<p>This method is approximately equivalent to:</p>
<pre><code class="lang-javascript">selection.select(selector).transition()
</code></pre>
<p>where <em>selection</em> is the current transition&#39;s underlying selection. In addition, the returned new transition inherits easing, duration and delay from the current transition.</p>
<p><a name="selectAll" href="Transitions#selectAll">#</a> transition.<b>selectAll</b>(<i>selector</i>)</p>
<p>For each element in the current transition, selects descendant elements that match the specified <em>selector</em> string. The returned selection is grouped by the ancestor node in the current selection. If no element matches the specified selector for the current element, the group at the current index will be empty in the returned selection. The subselection does not inherit data from the current selection; however, if data was previously bound to the selected elements, that data will be available to operators.</p>
<p>This method is approximately equivalent to:</p>
<pre><code class="lang-javascript">selection.selectAll(selector).transition()
</code></pre>
<p>where <em>selection</em> is the current transition&#39;s underlying selection. In addition, the returned new transition inherits easing, duration and delay from the current transition. The duration and delay for each subelement is inherited from the duration and delay of the parent element in the current transition.</p>
<p><a name="filter" href="#filter">#</a> transition.<b>filter</b>(<i>selector</i>)</p>
<p>Filters the transition, returning a new transition that contains only the elements for which the specified <em>selector</em> is true. The <em>selector</em> may be specified either as a function or as a selector string, such as &quot;.foo&quot;. As with other operators, the function is passed the current datum <code>d</code> and index <code>i</code>, with the <code>this</code> context as the current DOM element. Like the built-in array [[filter|<a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/Filter">https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/Filter</a>]] method, the returned selection <em>does not</em> preserve the index of the original selection; it returns a copy with elements removed. If you want to preserve the index, use <a href="#select">select</a> instead. For example, to select every other element:</p>
<pre><code class="lang-javascript">var odds = transition.select(function(d, i) { return i &amp; 1 ? this : null; });
</code></pre>
<p>Equivalently, using a filter function:</p>
<pre><code class="lang-javascript">var odds = transition.filter(function(d, i) { return i &amp; 1; });
</code></pre>
<p>Or a filter selector:</p>
<pre><code class="lang-javascript">var odds = transition.filter(&quot;:nth-child(odd)&quot;);
</code></pre>
<p>Thus, you can use either select or filter to apply tweens to a subset of elements.</p>
<p><a name="transition" href="Transitions#transition">#</a> transition.<b>transition</b>()</p>
<p>Creates a new transition on the same selected elements that starts when this transition ends. The new transition inherits this transition’s duration and easing. This can be used to define <a href="http://bl.ocks.org/mbostock/4341417">chained transitions</a> without needing to listen for &quot;end&quot; events.</p>
<h3 id="control">Control</h3>
<p><a name="each" href="Transitions#each">#</a> transition.<b>each</b>([<i>type</i>, ]<i>listener</i>)</p>
<p>If <i>type</i> is specified, adds a listener for transition events, supporting &quot;start&quot;, &quot;end&quot; and &quot;interrupt&quot; events. The listener will be invoked for each individual element in the transition.</p>
<p>The <em>start</em> event is invoked during the first asynchronous callback (tick) of the transition, before any tweens are invoked. For transitions with zero delay, this is typically about 17ms after the transition is scheduled. State events are useful for triggering instantaneous changes to each element, such as changing attributes that cannot be interpolated.</p>
<p>The <em>end</em> event is invoked during the last asynchronous callback (tick) after the transition duration and delay expires, after all tweens are invoked with t=1. Note that if the transition is superseded by a later-scheduled transition on a given element, no end event will be dispatched for that element; interrupted transitions do not trigger end events. For example, <a href="#remove">transition.remove</a> schedules each element to be removed when the transition ends, but if the transition is interrupted, the element will not be removed. End events can be used as an alternative to <a href="#transition">transition.transition</a> to create <a href="http://bl.ocks.org/mbostock/1125997">chained transitions</a> by selecting the current element, <code>this</code>, and deriving a new transition; however, this can lead to clock drift over time and thus transition.transition should be preferred.</p>
<p>The <em>interrupt</em> event is invoked if an active transition is interrupted by another transition of the same name on the same element. The interrupt event is dispatched on the interrupted transition immediately prior to the start event on the interrupting transition. Note that if a transition is cancelled before it starts (such as when a later-scheduled transition starts before a delayed transition), no interrupt event is dispatched.</p>
<p>If <i>type</i> is not specified, behaves similarly to <a href="Selections#each">selection.each</a>: immediately invokes the specified <em>function</em> for each element in the current transition, passing in the current datum <code>d</code> and index <code>i</code>, with the <code>this</code> context of the current DOM element. Any transitions created within the scope of transition.each will inherit transition parameters from the parent transition, including id, delay, duration and easing. Thus, transitions created within a transition.each will not interrupt the parent transition, similar to <a href="#transition">subtransitions</a>.</p>
<p>The transition.each method can be used to chain transitions and apply shared timing across a set of transitions. For example:</p>
<pre><code class="lang-js">d3.transition()
    .duration(750)
    .ease(&quot;linear&quot;)
    .each(function() {
      d3.selectAll(&quot;.foo&quot;).transition()
          .style(&quot;opacity&quot;, 0)
         .remove();
    })
  .transition()
    .each(function() {
      d3.selectAll(&quot;.bar&quot;).transition()
        .style(&quot;opacity&quot;, 0)
        .remove();
    });
</code></pre>
<p>By using <code>d3.select(this)</code> within transition.each, you can even inherit staggered delay across a set of selected elements. This technique is used by the <a href="SVG-Axes">Axis component</a> to support <a href="http://bl.ocks.org/mbostock/1166403">automatic transitions</a>.</p>
<p>See also the <a href="http://bl.ocks.org/mbostock/5779690">Exit, Update, Enter</a> example.</p>
<p><a name="call" href="Transitions#call">#</a> transition.<b>call</b>(<i>function</i>[, <i>arguments…</i>])</p>
<p>Invokes the specified <em>function</em> once, passing in the current transition along with any optional <em>arguments</em>. The call operator always returns the current transition, regardless of the return value of the specified function. The call operator is identical to invoking a function by hand; but it makes it easier to use method chaining. For example, say we want to set a number of attributes the same way in a number of different places. So we take the code and wrap it in a reusable function:</p>
<pre><code class="lang-javascript">function foo(transition) {
  transition
      .attr(&quot;name1&quot;, &quot;value1&quot;)
      .attr(&quot;name2&quot;, &quot;value2&quot;);
}
</code></pre>
<p>Now, we can say this:</p>
<pre><code class="lang-javascript">foo(d3.selectAll(&quot;div&quot;).transition())
</code></pre>
<p>Or equivalently:</p>
<pre><code class="lang-javascript">d3.selectAll(&quot;div&quot;).transition().call(foo);
</code></pre>
<p>In many cases, it is possible to call the same function <em>foo</em> on both transitions and selections, due to identical methods on both selections and transitions! The <code>this</code> context of the called function is also the current transition. This is slightly redundant with the first argument, which we might fix in the future.</p>
<p><a name="empty" href="Transitions#empty">#</a> transition.<b>empty</b>()</p>
<p>Returns true if the current transition is empty; a transition is empty if it contains no non-null elements.</p>
<p><a name="node" href="Transitions#node">#</a> transition.<b>node</b>()</p>
<p>Returns the first non-null element in the current transition. If the transition is empty, returns null.</p>
<p><a name="size" href="Transitions#size">#</a> transition.<b>size</b>()</p>
<p>Returns the total number of elements in the current transition.</p>
<h2 id="easing">Easing</h2>
<p><a name="d3_ease" href="Transitions#d3_ease">#</a> d3.<b>ease</b>(<i>type</i>[, <i>arguments…</i>])</p>
<p>Returns a built-in easing function of the specified <em>type</em>, with any optional <em>arguments</em>. An easing function takes the current parameterized time value <em>t</em> in the domain [0,1], and maps it to another value in a similar range; it is typically used to set transition <a href="Transitions#ease">easing</a>. The following easing types are supported:</p>
<ul>
<li>linear - the identity function, <em>t</em>.</li>
<li>poly(k) - raises <em>t</em> to the specified power <em>k</em> (e.g., 3).</li>
<li>quad - equivalent to poly(2).</li>
<li>cubic - equivalent to poly(3).</li>
<li>sin - applies the trigonometric function <em>sin</em>.</li>
<li>exp - raises 2 to a power based on <em>t</em>.</li>
<li>circle - the quarter circle.</li>
<li>elastic(a, p) - simulates an elastic band; may extend slightly beyond 0 and 1.</li>
<li>back(s) - simulates backing into a parking space.</li>
<li>bounce - simulates a bouncy collision.</li>
</ul>
<p>These built-in types may be extended using a variety of modes:</p>
<ul>
<li>in - the identity function.</li>
<li>out - reverses the easing direction to [1,0].</li>
<li>in-out - copies and mirrors the easing function from [0,.5] and [.5,1].</li>
<li>out-in - copies and mirrors the easing function from [1,.5] and [.5,0].</li>
</ul>
<p>The default easing function is &quot;cubic-in-out&quot; which provides suitable [[slow-in slow-out|<a href="http://en.wikipedia.org/wiki/12_basic_principles_of_animation#Slow_in_and_slow_out">http://en.wikipedia.org/wiki/12_basic_principles_of_animation#Slow_in_and_slow_out</a>]] animation.</p>
<p><a name="_ease" href="Transitions#_ease">#</a> <b>ease</b>(<i>t</i>)</p>
<p>Given a parametric time <em>t</em>, typically in the range [0,1], returns the eased time. The returned value is typically in the range [0,1] as well, but may extend slightly beyond this range for certain easing functions, such as &quot;elastic&quot;.</p>
<h2 id="timers">Timers</h2>
<p>D3 internally maintains an efficient timer queue so that thousands of timers can be processed concurrently with minimal overhead; in addition, this timer queue guarantees consistent timing of animations when concurrent or staged transitions are scheduled. If your browser supports it, the timer queue will use [[requestAnimationFrame|<a href="http://paulirish.com/2011/requestanimationframe-for-smart-animating/">http://paulirish.com/2011/requestanimationframe-for-smart-animating/</a>]] for fluid and efficient animation. The timer queue is also smart about using setTimeout when there is a long delay before the next scheduled event.</p>
<p><a name="d3_timer" href="Transitions#d3_timer">#</a> d3.<b>timer</b>(<i>function</i>[, <i>delay</i>[, <i>time</i>]])</p>
<p>Start a custom animation timer, invoking the specified <em>function</em> repeatedly until it returns true. There is no way to cancel the timer after it starts, so make sure your timer function returns true when done!</p>
<p>An optional numeric <em>delay</em> in milliseconds may be specified when the given <em>function</em> should only be invoked after a delay. The delay is relative to the specified <em>time</em> in milliseconds since UNIX epoch; if <em>time</em> is not specified, it defaults to <a href="https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date/now">Date.now</a>.</p>
<p>You may use <em>delay</em> and <em>time</em> to specify relative and absolute moments in time when the <em>function</em> should start being invoked. For example, a calendar notification might be coded as:</p>
<pre><code class="lang-js">d3.timer(notify, -4 * 1000 * 60 * 60, +new Date(2012, 09, 29)); // four hours before midnight October 29 (months are zero-based)
</code></pre>
<p><a name="d3_timer_flush" href="Transitions#d3_timer_flush">#</a> d3.timer.<b>flush</b>()</p>
<p>Immediately execute (invoke once) any active timers. Normally, zero-delay transitions are executed after an instantaneous delay (&lt;10ms). This can cause a brief flicker if the browser renders the page twice: once at the end of the first event loop, then again immediately on the first timer callback. By flushing the timer queue at the end of the first event loop, you can run any zero-delay transitions immediately and avoid the flicker.</p>
<h2 id="interpolation">Interpolation</h2>
<p>D3 has many built-in interpolators to simplify the transitioning of arbitrary values; an interpolator is a function that maps a parametric value <em>t</em> in the domain [0,1] to a color, number or arbitrary value.</p>
<p><a name="d3_interpolate" href="Transitions#d3_interpolate">#</a> d3.<b>interpolate</b>(<i>a</i>, <i>b</i>)</p>
<p>Returns the default interpolator between the two values <em>a</em> and <em>b</em>. The type of interpolator is based on the type of the end value <em>b</em>, using the following algorithm:</p>
<ol>
<li>If <em>b</em> is a color, interpolateRgb is used.</li>
<li>If <em>b</em> is a string, interpolateString is used.</li>
<li>If <em>b</em> is an array, interpolateArray is used.</li>
<li>If <em>b</em> is an object and not coercible to a number, interpolateObject is used.</li>
<li>Otherwise, interpolateNumber is used.</li>
</ol>
<p>Based on the chosen interpolator, <em>a</em> is coerced to a suitable corresponding type. The color check applies to both instances of <a href="Colors#d3_rgb">d3.rgb</a> and other color spaces as well as color strings of the form <code>/^(#|rgb\(|hsl\()/</code> or a [[CSS named colors|<a href="http://www.w3.org/TR/SVG/types.html#ColorKeywords">http://www.w3.org/TR/SVG/types.html#ColorKeywords</a>]].</p>
<p>The behavior of this default interpolator may be extended to support additional types by pushing custom interpolators onto the <a href="Transitions#d3_interpolators">d3.interpolators</a> array.</p>
<p><a name="_interpolate" href="Transitions#_interpolate">#</a> <b>interpolate</b>(<i>t</i>)</p>
<p>Given a parameter <em>t</em> typically in the range [0,1], returns the associated interpolation value. Interpolators are commonly used in conjunction with scales to map an input domain (such as a quantitative dimension) to an output range (such as a range of colors or pixel positions).</p>
<p><a name="d3_interpolateNumber" href="Transitions#d3_interpolateNumber">#</a> d3.<b>interpolateNumber</b>(<i>a</i>, <i>b</i>)</p>
<p>Returns a numeric interpolator between the two numbers <em>a</em> and <em>b</em>. The returned interpolator is equivalent to:</p>
<pre><code class="lang-javascript">function interpolate(t) {
  return a * (1 - t) + b * t;
}
</code></pre>
<p>Caution: avoid interpolating to or from the number zero when the interpolator is used to generate a string (such as with <a href="Transitions#attr">attr</a>). Very small values, when stringified, may be converted to scientific notation and cause a temporarily invalid attribute or style property value. For example, the number 0.0000001 is converted to the string &quot;1e-7&quot;. This is particularly noticeable when interpolating opacity values. To avoid scientific notation, start or end the transition at 1e-6, which is the smallest value that is not stringified in exponential notation.</p>
<p><a name="d3_interpolateRound" href="Transitions#d3_interpolateRound">#</a> d3.<b>interpolateRound</b>(<i>a</i>, <i>b</i>)</p>
<p>Returns a numeric interpolator between the two numbers <em>a</em> and <em>b</em>; the interpolator is similar to <a href="Transitions#d3_interpolateNumber">interpolateNumber</a>, except it will round the resulting value to the nearest integer.</p>
<p><a name="d3_interpolateString" href="Transitions#d3_interpolateString">#</a> d3.<b>interpolateString</b>(<i>a</i>, <i>b</i>)</p>
<p>Returns a string interpolator between the two strings <em>a</em> and <em>b</em>. The string interpolator finds numbers embedded in <em>a</em> and <em>b</em>, where each number is of the form:</p>
<pre><code class="lang-javascript">/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g
</code></pre>
<p>For each number embedded in <em>b</em>, the interpolator will attempt to find a corresponding number in <em>a</em>. If a corresponding number is found, a numeric interpolator is created using <a href="Transitions#d3_interpolateNumber">interpolateNumber</a>. The remaining parts of the string <em>b</em> are used as a template: the static parts of the string <em>b</em> remain constant for the interpolation, with the interpolated numeric values embedded in the template. For example, if <em>a</em> is &quot;300 12px sans-serif&quot;, and <em>b</em> is &quot;500 36px Comic-Sans&quot;, two embedded numbers are found. The remaining static parts of the string are a space between the two numbers (&quot; &quot;), and the suffix (&quot;px Comic-Sans&quot;). The result of the interpolator at <em>t</em> = .5 is &quot;400 24px Comic-Sans&quot;.</p>
<p><a name="d3_interpolateRgb" href="Transitions#d3_interpolateRgb">#</a> d3.<b>interpolateRgb</b>(<i>a</i>, <i>b</i>)</p>
<p>Returns an RGB color space interpolator between the two colors <em>a</em> and <em>b</em>. The colors <em>a</em> and <em>b</em> need not be in RGB, but they will be converted to RGB using <a href="Colors#d3_rgb">d3.rgb</a>. The red, green and blue channels are interpolated linearly in a manner equivalent to <a href="Transitions#d3_interpolateRound">interpolateRound</a>, as fractional channel values are not allowed. The return value of the interpolator is a hexadecimal RGB string.</p>
<p><a name="d3_interpolateHsl" href="Transitions#d3_interpolateHsl">#</a> d3.<b>interpolateHsl</b>(<i>a</i>, <i>b</i>)</p>
<p>Returns an HSL color space interpolator between the two colors <em>a</em> and <em>b</em>. The colors <em>a</em> and <em>b</em> need not be in HSL, but they will be converted to HSL using [[d3.hsl|Colors#d3_hsl]]. The hue, saturation and lightness are interpolated linearly in a manner equivalent to <a href="Transitions#d3_interpolateNumber">interpolateNumber</a>. (The shortest path between the start and end hue is used.) The return value of the interpolator is a hexadecimal RGB string.</p>
<p><a name="d3_interpolateLab" href="#d3_interpolateLab">#</a> d3.<b>interpolateLab</b>(<i>a</i>, <i>b</i>)</p>
<p>Returns a L*a*b* color space interpolator between the two colors <em>a</em> and <em>b</em>. The colors <em>a</em> and <em>b</em> will be converted to L*a*\b* if necessary using [[d3.lab|Colors#d3_lab]]. The color channels are then interpolated linearly in a manner equivalent to <a href="Transitions#d3_interpolateNumber">interpolateNumber</a>. The return value of the interpolator is a hexadecimal RGB string.</p>
<p><a name="d3_interpolateHcl" href="#d3_interpolateHcl">#</a> d3.<b>interpolateHcl</b>(<i>a</i>, <i>b</i>)</p>
<p>Returns an HCL color space interpolator between the two colors <em>a</em> and <em>b</em>. The colors <em>a</em> and <em>b</em> will be converted to HCL if necessary using [[d3.hcl|Colors#d3_hcl]]. The color channels are then interpolated linearly in a manner equivalent to <a href="Transitions#d3_interpolateNumber">interpolateNumber</a>. (The shortest path between the start and end hue is used.) The return value of the interpolator is a hexadecimal RGB string.</p>
<p><a name="d3_interpolateArray" href="Transitions#d3_interpolateArray">#</a> d3.<b>interpolateArray</b>(<i>a</i>, <i>b</i>)</p>
<p>Returns an array interpolator between the two arrays <em>a</em> and <em>b</em>. Internally, an array template is created that is the same length in <em>b</em>. For each element in <em>b</em>, if there exists a corresponding element in <em>a</em>, a generic interpolator is created for the two elements using <a href="Transitions#d3_interpolate">interpolate</a>. If there is no such element, the static value from <em>b</em> is used in the template. Then, for the given parameter <em>t</em>, the template&#39;s embedded interpolators are evaluated. The updated array template is then returned. For example, if <em>a</em> is the array [0, 1] and <em>b</em> is the array [1, 10, 100], then the result of the interpolator for <em>t</em> = .5 is the array [.5, 5.5, 100].</p>
<p>Note: no defensive copy of the template array is created; modifications of the returned array may adversely affect subsequent evaluation of the interpolator. No copy is made because interpolators should be fast, as they are part of the inner loop of animation.</p>
<p><a name="d3_interpolateObject" href="Transitions#d3_interpolateObject">#</a> d3.<b>interpolateObject</b>(<i>a</i>, <i>b</i>)</p>
<p>Returns an object interpolator between the two objects <em>a</em> and <em>b</em>. Internally, an object template is created that has the same properties as <em>b</em>. For each property in <em>b</em>, if there exists a corresponding property in <em>a</em>, a generic interpolator is created for the two elements using <a href="Transitions#d3_interpolate">interpolate</a>. If there is no such property, the static value from <em>b</em> is used in the template. Then, for the given parameter <em>t</em>, the template&#39;s embedded interpolators are evaluated and the updated object template is then returned. For example, if <em>a</em> is the object {x: 0, y: 1} and <em>b</em> is the object {x: 1, y: 10, z: 100}, the result of the interpolator for <em>t</em> = .5 is the object {x: .5, y: 5.5, z: 100}.</p>
<p>Object interpolation is particularly useful for <em>dataspace interpolation</em>, where data is interpolated rather than attribute values. For example, you can interpolate an object which describes an arc in a pie chart, and then use [[d3.svg.arc|SVG-Shapes#arc]] to compute the new SVG path data.</p>
<p>Note: no defensive copy of the template object is created; modifications of the returned object may adversely affect subsequent evaluation of the interpolator. No copy is made because interpolators should be fast, as they are part of the inner loop of animation.</p>
<p><a name="d3_interpolateTransform" href="Transitions#d3_interpolateTransform">#</a> d3.<b>interpolateTransform</b>(<i>a</i>, <i>b</i>)</p>
<p>Returns an interpolator between the two 2D affine <a href="Math#transform">transforms</a> represented by <em>a</em> and <em>b</em>. Each transform is decomposed to a standard representation of translate, rotate, <em>x</em>-skew and scale; these component transformations are then interpolated. This behavior is standardized by CSS: see <a href="http://www.w3.org/TR/css3-2d-transforms/#matrix-decomposition">matrix decomposition for animation</a>.</p>
<p><a name="d3_interpolateZoom" href="#d3_interpolateZoom">#</a> d3.<b>interpolateZoom</b>(<i>a</i>, <i>b</i>)</p>
<p>Returns a smooth <a href="#_interpolate">interpolator</a> between the two views <em>a</em> and <em>b</em> of a two-dimensional plane, based on <a href="https://www.google.com/search?q=Smooth+and+efficient+zooming+and+panning">“Smooth and efficient zooming and panning”</a> by Jarke J. van Wijk and Wim A.A. Nuij. Each view is defined as an array of three numbers: <em>cx</em>, <em>cy</em> and <em>width</em>. The first two coordinates <em>cx</em>, <em>cy</em> represent the center of the viewport; the last coordinate <em>width</em> represents the size of the viewport. The returned interpolator also has a <em>duration</em> property which encodes the recommended transition duration in milliseconds. This duration is based on the path length of the curved trajectory through <em>x,y</em> space. If you want to a slower or faster transition, multiply this by an arbitrary scale factor (<i>V</i> as described in the original paper).</p>
<p><a href="Geo-Paths#interpolate">#</a> d3.geo.<b>interpolate</b>(<i>a</i>, <i>b</i>)</p>
<p>See <a href="Geo-Paths#interpolate">d3.geo.interpolate</a>.</p>
<p><a name="d3_interpolators" href="Transitions#d3_interpolators">#</a> d3.<b>interpolators</b></p>
<p>The array of built-in interpolator factories, as used by <a href="Transitions#d3_interpolate">d3.interpolate</a>. Additional interpolator factories may be pushed onto the end of this array. Each factory may return an interpolator, if it supports interpolating the two specified input values; otherwise, the factory should return a falsey value and other interpolators will be tried.</p>
<p>For example, to register a custom interpolator that formats dollars and cents, you might say:</p>
<pre><code class="lang-javascript">d3.interpolators.push(function(a, b) {
  var re = /^\$([0-9,.]+)$/, ma, mb, f = d3.format(&quot;,.02f&quot;);
  if ((ma = re.exec(a)) &amp;&amp; (mb = re.exec(b))) {
    a = parseFloat(ma[1]);
    b = parseFloat(mb[1]) - a;
    return function(t) {
      return &quot;$&quot; + f(a + b * t);
    };
  }
});
</code></pre>
<p>Then, <code>d3.interpolate(&quot;$20&quot;, &quot;$10&quot;)(1/3)</code> returns <code>$16.67</code>.</p>

    </div>
  </body>
</html>
