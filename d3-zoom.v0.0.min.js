!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("d3-dispatch"),require("d3-interpolate"),require("d3-selection"),require("d3-transition")):"function"==typeof define&&define.amd?define(["exports","d3-dispatch","d3-interpolate","d3-selection","d3-transition"],n):n(t.d3_zoom=t.d3_zoom||{},t.d3_dispatch,t.d3_interpolate,t.d3_selection,t.d3_transition)}(this,function(t,n,o,e,i){"use strict";function r(t){return function(){return t}}function u(t,n){this.type=t,this.scale=n.k,this.translate=[n.x,n.y]}function s(t,n,o){this.k=t,this.x=n,this.y=o}function c(t){return null==t?m:t.__zoom}function a(){return"wheel"===e.event.type?e.event.deltaY:!e.event.button}function p(){var t=this.ownerSVGElement||this;return[t.clientWidth,t.clientHeight]}function l(){return this.__zoom||m}function f(t){function c(t){t.on("wheel.zoom",k).on("mousedown.zoom",w).on("dblclick.zoom",x).on("touchstart.zoom",g).on("touchmove.zoom",b).on("touchend.zoom touchcancel.zoom",M).style("-webkit-tap-highlight-color","rgba(0,0,0,0)").property("__zoom",l)}function f(t){return function(){var n="function"==typeof t?t.apply(this,arguments):t;if(B>n.k||n.k>D){var o=V||(o=j.apply(this,arguments),[o[0]/2,o[1]/2]),e=n.invert(o);n=m(h(n,n.k),o,e)}return n}}function h(t,n){return new s(Math.max(B,Math.min(D,n)),t.x,t.y)}function m(t,n,o){return o=t.apply(o),new s(t.k,t.x+n[0]-o[0],t.y+n[1]-o[1])}function y(t,n,e){t.on("start.zoom",_).on("interrupt.zoom end.zoom",z).tween("zoom:zoom",function(){var t=this,i=arguments,r=j.apply(t,i),u=e||[r[0]/2,r[1]/2],c=Math.max(r[0],r[1]),a=t.__zoom,p="function"==typeof n?n.apply(t,i):n,l=o.interpolateZoom(a.invert(u).concat(c/a.k),p.invert(u).concat(c/p.k));return function(n){if(1===n)t.__zoom=p;else{var o=l(n),e=c/o[2];t.__zoom=new s(e,u[0]-o[0]*e,u[1]-o[1]*e)}v.apply(t,i)}})}function _(){1===++H&&d("start",this,arguments)}function v(){d("zoom",this,arguments)}function z(){0===--H&&d("end",this,arguments)}function d(t,n,o){e.customEvent(new u(t,n.__zoom),W.apply,W,[t,n,o])}function k(){function t(){T=null,z.apply(n,o)}if(Y.apply(this,arguments)){var n=this,o=arguments,r=n.__zoom;T?clearTimeout(T):(V&&(q=r.invert(V)),S=r.invert(E=e.mouse(n)),i.interrupt(n),_.apply(n,o)),r=h(r,r.k*Math.pow(2,-e.event.deltaY*(e.event.deltaMode?120:1)/500)),V?(r=m(r,V,q),S=r.invert(E)):r=m(r,E,S),n.__zoom=r,e.event.preventDefault(),T=setTimeout(t,K),v.apply(n,o)}}function w(){function t(){o.__zoom=m(o.__zoom,E=e.mouse(o),S),V&&(q=o.__zoom.invert(V)),v.apply(o,r)}function n(){e.select(e.event.view).on("mousemove.zoom mouseup.zoom",null),z.apply(o,r)}if(Y.apply(this,arguments)){var o=this,r=arguments;S=o.__zoom.invert(E=e.mouse(o)),e.select(e.event.view).on("mousemove.zoom",t,!0).on("mouseup.zoom",n,!0),i.interrupt(o),_.apply(o,r)}}function x(){if(Y.apply(this,arguments)){var t=this.__zoom,n=V||e.mouse(this),o=t.invert(n),i=t.k*(e.event.shiftKey?.5:2),r=m(h(t,i),n,o);G>0?e.select(this).transition().duration(G).call(y,r,n):this.__zoom=r}}function g(){}function b(){}function M(){}var T,q,E,S,Y=a,j=p,B=0,D=1/0,G=250,H=0,K=150,V=null,W=n.dispatch("start","zoom","end").on("start",t);return c.transform=function(t,n){var o=t.selection?t.selection():t;n=f(n),o.property("__zoom",l),t instanceof i.transition?y(t,n,V):t.interrupt().each(_).property("__zoom",n).each(v).each(z)},c.scaleBy=function(t,n){c.scaleTo(t,function(){var t=this.__zoom.k,o="function"==typeof n?n.apply(this,arguments):n;return t*o})},c.scaleTo=function(t,n){c.transform(t,function(){var t=V||(t=j.apply(this,arguments),[t[0]/2,t[1]/2]),o=this.__zoom.invert(t),e="function"==typeof n?n.apply(this,arguments):n;return m(h(this.__zoom,e),t,o)})},c.filter=function(t){return arguments.length?(Y="function"==typeof t?t:r(!!t),c):Y},c.size=function(t){return arguments.length?(j="function"==typeof t?t:r([+t[0],+t[1]]),c):j},c.scaleExtent=function(t){return arguments.length?(B=+t[0],D=+t[1],c):[B,D]},c.center=function(t){return arguments.length?(V=null==t?null:[+t[0],+t[1]],c):V},c.duration=function(t){return arguments.length?(G=+t,c):G},c.on=function(){var t=W.on.apply(W,arguments);return t===W?c:t},c}var h="0.0.2";s.prototype={constructor:s,apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},scale:function(t){return new s(this.k*t,this.x,this.y)},translate:function(t,n){return new s(this.k,this.x+this.k*t,this.y+this.k*n)},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var m=new s(1,0,0);c.prototype=s.prototype,t.version=h,t.zoom=f,t.zoomTransform=c});